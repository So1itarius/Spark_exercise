# Spark_exercises

## Описание классов:

_SparkDrivers_ - класс, со следующими задачами : 
1. Посчитать уникальных пользователей в логах (**unique_users**)
2. Смаппить пользователей и IP адреса (**users_ip_map**)
3. Смаппить IP адреся и пользователей (**ip_users_map**)
4. [**пока не сделано**] Найти подозрительные действия аутентификации (LOGIN), т.е. с одного IP аутентифицировались разные пользователи в интервале 2 секунд (**spam_ip**)


_SparkSQL_ - класс, со следующими (тренировочными) задачами по SQL: 

1. Используя данные из файла energy-usage-2010.csv рассчитать суммарное потребление энергии по месяцам (KWH JANUARY 2010, KWH FEBRUARY 2010 и т.д.) в разрезе территорий (COMMUNITY AREA NAME) (**total_consumption**)
2. Используя файл RUvideos.csv найти 10 наиболее популярых видое (по просмотрам) (**most_popular_videos**)
3. Используя файл RUvideos.csv найти наиболее популярные видео (по просмотрам) в разрезе месяцев  (**most_popular_videos_for_month**)


_SparkSQLTasks_ -  класс, со следующими (основными) задачами по SQL:

4. Рассчитать среднее время исполнения заявки в разрезе страховых компаний (**AVG_time**)
5. На основании набора (event_data_train.csv) найти всех пользователей, которые полностью прошли курс (**course_users**)
6. На основании набора (submissions_data_train.csv) найти сколько задач успешно решили пользователи, которые прошли курс полностью (**completed_tasks**)
7. [**задача не решена, неочевидные условия поиска**] Найти id автора курса 
8. Для каждого пользователя найдите такой шаг, который он не смог решить, и после этого не пытался решать другие шаги. Затем найдите id шага,  который стал финальной точкой практического обучения на курсе для максимального числа пользователей.(**most_difficult_task**)

## Запуск

Пока работает запуск только через IntelliJ IDEA:
    В каждом классе нужно раскоментить нужную функцию и запустить(Shift+F10).
